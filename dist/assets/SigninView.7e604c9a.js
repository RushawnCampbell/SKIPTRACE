import{_ as l,o as d,c as m,a as c,t as u,w as p,b as f,r as g,d as h}from"./index.f4fa2584.js";const _={data(){return{messages:"",csrf_token:""}},methods:{signin(){let n=document.getElementById("signinForm"),e=new FormData(n),i=this,o=0,s=document.querySelector("section#msg"),r=document.querySelectorAll("div input");fetch("/api/auth/signin",{method:"POST",body:e,headers:{Accept:"application/json","X-CSRFToken":this.csrf_token}}).then(t=>(o=t.status,t.json())).then(t=>{o==200?(sessionStorage.setItem("token",t.token),sessionStorage.setItem("isauth","true"),localStorage.setItem("authed",!0),r.forEach(a=>{a.value=""}),fetch("/api/uid",{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${sessionStorage.getItem("token")}`}}).then(function(a){return a.json()}).then(function(a){sessionStorage.setItem("uid",a.message)}),this.$router.push("/search")):o==401&&(i.messages=t.message,s.classList.remove("alert-success"),s.classList.add("alert-danger"),s.classList.remove("hide"),s.classList.add("show"))})},getCsrfToken(){let n=this;fetch("/api/csrf-token").then(e=>e.json()).then(e=>{n.csrf_token=e.csrf_token})}},created(){this.getCsrfToken()}},S={class:"formcombo"},b=c("h2",null,"Sign in to access your portal.",-1),v={id:"msg",class:"form-control alert hide"},k=f('<div class="form-group"><label for="username">Username</label><br><input type="text" class="form-control" id="username" name="username"></div><div class="form-group"><label for="pasword">Password</label><br><input type="password" class="form-control" id="password" name="password"></div><button type="submit" class="btn btn-success mb-2">Sign in</button>',3),y=[k];function w(n,e,i,o,s,r){return d(),m("section",S,[b,c("section",v,u(s.messages),1),c("form",{onSubmit:e[0]||(e[0]=p((...t)=>r.signin&&r.signin(...t),["prevent"])),Mmethod:"POST",id:"signinForm"},y,32)])}var $=l(_,[["render",w]]);const x={data(){return{message:"Login!"}},components:{Signin:$}};function B(n,e,i,o,s,r){const t=g("Signin");return d(),h(t)}var T=l(x,[["render",B]]);export{T as default};
